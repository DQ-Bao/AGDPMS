@page "/"
@using Microsoft.AspNetCore.Components.Web
@inject NavigationManager Navigation

<PageTitle>Home</PageTitle>

<div class="main-layout">
    <div class="header">
        <h1>AGDPMS</h1>
        <div class="user-info">
            <span>Hello, @GetUserFullName()!</span>
            <button @onclick="Logout" class="logout-btn">Logout</button>
        </div>
    </div>
    
    <div class="content">
        <h2>Welcome to your new app.</h2>
        
        <div class="user-details">
            <h3>User Information:</h3>
            <ul>
                <li>Full Name: @GetUserFullName()</li>
                <li>Phone: @GetUserPhone()</li>
                <li>Role: @GetUserRole()</li>
            </ul>
        </div>
        
        <div class="actions">
            <a href="/accounts" class="action-btn">Accounts</a>
        </div>
    </div>
</div>

@code {
    private string GetUserFullName()
    {
        return Microsoft.Maui.Storage.Preferences.Default.Get("rememberedFullName", "User");
    }
    
    private string GetUserPhone()
    {
        return Microsoft.Maui.Storage.Preferences.Default.Get("rememberedPhone", "");
    }
    
    private string GetUserRole()
    {
        return Microsoft.Maui.Storage.Preferences.Default.Get("rememberedRole", "");
    }
    
    private void Logout()
    {
        // Clear stored preferences
        Microsoft.Maui.Storage.Preferences.Default.Remove("remembered");
        Microsoft.Maui.Storage.Preferences.Default.Remove("rememberedUserId");
        Microsoft.Maui.Storage.Preferences.Default.Remove("rememberedPhone");
        Microsoft.Maui.Storage.Preferences.Default.Remove("rememberedFullName");
        Microsoft.Maui.Storage.Preferences.Default.Remove("rememberedRole");
        
        // Navigate to login page
        Navigation.NavigateTo("/login");
    }
}